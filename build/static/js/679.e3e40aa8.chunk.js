"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[679],{8582:function(e,n,t){t.d(n,{Z:function(){return u}});t(7313);var r=t(6149),a=t(3604),o=t(6467),i=t(1113),c=t(4117),s=t(1095),l=t(6417);function u(e){let{open:n,title:t,content:u,onClose:d,onConfirm:p}=e;return(0,l.jsxs)(r.Z,{open:n,onClose:()=>d(!1),children:[(0,l.jsx)(a.Z,{children:t||"Confirm"}),(0,l.jsx)(o.Z,{children:(0,l.jsx)(i.Z,{children:u||"Are you sure you want to proceed?"})}),(0,l.jsxs)(c.Z,{children:[(0,l.jsx)(s.Z,{onClick:()=>d(!1),color:"inherit",children:"No"}),(0,l.jsx)(s.Z,{onClick:p,color:"error",variant:"contained",children:"Yes"})]})]})}},2186:function(e,n,t){t.d(n,{Z:function(){return p}});var r=t(3365),a=t(6149),o=t(3604),i=t(2832),c=t(1113),s=t(7313),l=t(1766),u=t(6417);const d=s.forwardRef((function(e,n){return(0,u.jsx)(r.Z,{ref:n,...e})}));function p(e){let{title:n,children:t,open:r,onClose:s,...p}=e;return(0,u.jsxs)(a.Z,{...p,open:r,TransitionComponent:d,children:[(0,u.jsx)(o.Z,{children:(0,u.jsxs)(i.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsx)(c.Z,{variant:"h2",color:"primary.main",children:n}),(0,u.jsx)(l.Z,{sx:{cursor:"pointer"},onClick:s})]})}),t]})}},9848:function(e,n,t){t.d(n,{Z:function(){return j}});var r=t(7313),a=t(7592),o=t(7551),i=t(9601),c=t(1405),s=t(5954),l=t(8210),u=t(8790),d=t(4481),p=t(9916),x=t(712),h=t(7474),m=t(7131),f=t(6417);const g=(0,a.ZP)((e=>(0,f.jsx)(i.Z,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},...e})))((e=>{let{theme:n}=e;return{"& .MuiPaper-root":{borderRadius:6,marginTop:n.spacing(1),minWidth:130,color:"light"===n.palette.mode?"rgb(55, 65, 81)":n.palette.grey[300],boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:n.palette.text.secondary,marginRight:n.spacing(1.5)},"&:active":{backgroundColor:(0,o.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity)}}}}}));function j(e){let{data:n,actions:t=["Edit","Delete"],onActionChange:a}=e;const[o,i]=r.useState(null),j=Boolean(o),y=e=>{i(null),a&&a({action:e,data:n})};return(0,f.jsxs)("div",{children:[(0,f.jsx)(m.Z,{variant:"contained",onClick:e=>{i(e.currentTarget)},children:(0,f.jsx)(l.Z,{})}),(0,f.jsx)(g,{id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},anchorEl:o,open:j,onClose:y,children:t.map(((e,n)=>"ADD TO QUEUE"==e.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>y(e),sx:{color:"green","&:hover":{backgroundColor:"rgba(72, 113, 247, 0.1)"}},children:[(0,f.jsx)(u.Z,{style:{color:"green"}}),"Add To Queue"]},n):"ADDBOOKING"==e.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>y(e),sx:{color:"green","&:hover":{backgroundColor:"rgba(72, 113, 247, 0.1)"}},children:[(0,f.jsx)(u.Z,{style:{color:"green"}}),"Add TO BOOKING"]},n):"EDIT"==e.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>y(e),children:[(0,f.jsx)(s.Z,{}),"Edit"]},n):"DELETE"==e.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>y(e),sx:{color:"red","&:hover":{backgroundColor:"rgba(255, 0, 0, 0.1)"}},children:[(0,f.jsx)(d.Z,{style:{color:"red"}}),"Delete"]},n):"VIEW"==e.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>y(e),children:[(0,f.jsx)(p.Z,{}),"View"]},n):"CANCEL"==e.toUpperCase()?(0,f.jsxs)(c.Z,{sx:{color:"red"},onClick:()=>y(e),children:[(0,f.jsx)(x.Z,{color:"primary",style:{color:"red"}}),"Cancel"]},n):(0,f.jsxs)(c.Z,{onClick:()=>y(e),children:[(0,f.jsx)(h.Z,{}),e]},n)))})]})}},1322:function(e,n,t){t.d(n,{BO:function(){return Z},BZ:function(){return u},EP:function(){return d},Jf:function(){return p},T:function(){return f},TC:function(){return S},U1:function(){return A},Ug:function(){return C},YD:function(){return k},Ym:function(){return m},_2:function(){return i},ai:function(){return w},iI:function(){return l},k:function(){return b},lQ:function(){return s},ly:function(){return y},nX:function(){return g},qL:function(){return _},r7:function(){return o},tI:function(){return c},to:function(){return h},uI:function(){return j},x4:function(){return a},xk:function(){return x}});const r=t(5662).Z.create({baseURL:"http://192.168.1.8:4001/api/",headers:{"Content-Type":"application/json"}});async function a(e){const n=await r.post("users/login",e);return n.data.access_token&&localStorage.setItem("token",n.data.access_token),n.data}async function o(){return(await r.get("menu")).data}async function i(e){return(await r.put("menu",e)).data}async function c(){return(await r.get("company")).data}async function s(e){return(await r.post("company",e)).data}async function l(){return(await r.get("department")).data}async function u(e){return(await r.post("department",e)).data}async function d(e){return(await r.put("department",e)).data}async function p(e,n){return(await r.get(`employee?company_id=${e}&employee_type=${n}`)).data}async function x(e){return(await r.post("employee",e)).data}async function h(e){return(await r.put("employee",e)).data}async function m(e){return(await r.post("/employee/search",e)).data}async function f(e){return(await r.post("/get-current-transaction",e)).data}async function g(e){return(await r.post("employee-transaction",e)).data}async function j(e){return(await r.post("delete-employee-transaction",e)).data}async function y(e){return(await r.post("fixed-transaction",e)).data}async function Z(e){return(await r.post("contractor-transaction",e)).data}async function C(e){return(await r.post("guest-transaction",e)).data}async function w(e){return(await r.post("expense",e)).data}async function _(e){return(await r.put("expense",e)).data}async function k(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const t=await r.get("expense?canteen_calendar_id="+e+"&menu_id="+n);return t.data}async function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const n=await r.get(`canteen-calender?is_settled=${e}`);return n.data}async function S(e){return(await r.post("do-settlement",e)).data}async function b(e){return(await r.get(`settlement-rates?canteenCalenderId=${e}`)).data}r.interceptors.request.use((async e=>{const n=localStorage.getItem("accessToken");return n?e.headers.Authorization="Bearer "+n:console.warn("Token not found in localStorage"),e}),(e=>Promise.reject(e))),r.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(console.log("Unauthorized, logging out..."),localStorage.clear(),Navigate("/login"),window.location.href="/login"),Promise.reject(e))))},4679:function(e,n,t){t.r(n),t.d(n,{default:function(){return v}});var r=t(7313),a=t(2832),o=t(1113),i=t(1806),c=t(1550),s=t(3306),l=t(8797),u=t(1405),d=t(3497),p=t(1629),x=t(6835),h=t(3477),m=t(4076),f=t(7478),g=t(3467),j=t(9848),y=t(6417);function Z(e){let{data:n,header:t,isShowSerialNo:r=!1,isShowAction:a=!1,actions:o=["Edit","Delete"],onActionChange:i,onClickAction:c,renderAction:s}=e;return(0,y.jsx)(d.Z,{children:(0,y.jsx)(p.Z,{children:(0,y.jsxs)(x.Z,{children:[(0,y.jsx)(h.Z,{children:(0,y.jsxs)(m.Z,{children:[r&&(0,y.jsx)(f.Z,{sx:{color:"primary.main"},children:"SLNO"}),t.map(((e,n)=>(0,y.jsx)(f.Z,{sx:{color:"primary.main"},children:e},n))),a&&(0,y.jsx)(f.Z,{sx:{color:"primary.main"},children:"Action"})]})}),(0,y.jsx)(g.Z,{children:n.map(((e,n)=>(0,y.jsxs)(m.Z,{children:[r&&(0,y.jsx)(f.Z,{children:n+1}),t.map(((n,t)=>(0,y.jsx)(f.Z,{children:"Action"===n&&s?s(e):e[n]},t))),a&&(0,y.jsx)(f.Z,{children:(0,y.jsx)(j.Z,{data:e,onActionChange:i,actions:o})})]},n)))})]})})})}function C(e){let{data:n}=e;const t=n.map((e=>({"Menu Id":e.menu_id,"Menu Name":e.menu_name,"Fixed Count":e.Fixed_Count,"Regular Count":e.Regular_Count,"Fixed Amount":e.Fixed_Amount,"Fixed Total Amount":e.Fixed_Total_Amount,"Total Expense":e.Total_Expense,"AC Dine Share":e.AC_Dine_Share,"Regular Amount":e.Regular_Amount})));return(0,y.jsx)(Z,{data:t,header:["Menu Id","Menu Name","Fixed Count","Regular Count","Fixed Amount","Fixed Total Amount","Total Expense","AC Dine Share","Regular Amount"],isShowSerialNo:!0,isShowAction:!1})}var w=t(409),_=t(1095);function k(e){let{settleClick:n,disableSettle:t}=e;return(0,y.jsx)(d.Z,{children:(0,y.jsxs)(a.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,y.jsx)(o.Z,{variant:"h3",color:"secondary.main",children:"Manage Settlement"}),(0,y.jsx)(i.Z,{children:(0,y.jsx)(_.Z,{variant:"contained",startIcon:(0,y.jsx)(w.Z,{}),sx:{mx:1,backgroundColor:"success.dark"},onClick:n,disabled:t,children:"Settle All"})})]})})}var A=t(1387),S=(t(2186),t(1322));var b=t(8582);function v(){const[e,n]=(0,r.useState)(!1),[t,d]=(0,r.useState)([]),[p,x]=(0,r.useState)([]),[h,m]=(0,r.useState)(""),[f,g]=(0,r.useState)(!1),j=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;try{const n=await(0,S.k)(e);d(n)}catch(n){console.error(n),A.Am.error("Error fetching expenses")}};(0,r.useEffect)((()=>{(async()=>{try{const e=await(0,S.U1)(0);x(e)}catch(e){console.error(e),A.Am.error("Error fetching calendar data")}})()}),[]);return(0,y.jsxs)(a.Z,{direction:"column",gap:2,children:[(0,y.jsx)(k,{buttonClick:()=>n(!0),selectedCalender:h,settleClick:()=>{g(!0)},disableSettle:!t.length}),(0,y.jsx)(o.Z,{variant:"h3",color:"secondary.main",children:"Select Calendar"}),(0,y.jsx)(i.Z,{sx:{mb:2},children:(0,y.jsxs)(c.Z,{fullWidth:!0,children:[(0,y.jsx)(s.Z,{children:"Select Date"}),(0,y.jsxs)(l.Z,{value:h,label:"Select Date",onChange:e=>(e=>{m(e),j(e)})(e.target.value),children:[(0,y.jsx)(u.Z,{value:"",children:(0,y.jsx)("em",{children:"Select a Date"})}),p.map((e=>(0,y.jsx)(u.Z,{value:e.canteen_calendar_id,children:e.month_year},e.canteen_calendar_id)))]})]})}),(0,y.jsx)(C,{data:t,updateData:j,canteenCalenderId:h}),(0,y.jsx)(b.Z,{open:f,title:"Settle Confirmation",content:"Are you sure you want to settle all menus?",onClose:()=>g(!1),onConfirm:async()=>{try{const e=t.map((e=>({menu_id:e.menu_id,amount:Number(e.Total_Expense||0)})));await(0,S.TC)({canteen_calendar_id:h,menus:e}),A.Am.success("Settlement successful"),j()}catch(e){A.Am.error("Settlement failed"),console.error(e)}finally{g(!1)}}})]})}}}]);