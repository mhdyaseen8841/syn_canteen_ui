"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[252],{2252:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var n=a(7313),r=a(2832),l=a(1113),o=a(1806),i=a(1550),s=a(3306),d=a(8797),c=a(1405),m=a(1629),p=a(6835),u=a(3477),h=a(4076),y=a(7478),x=a(3467),v=a(6212),j=a(7970),_=a(3497),f=a(9848),Z=a(6417);function g(e){let{data:t,header:a,isShowSerialNo:l=!1,isShowAction:o=!1,actions:i=["Edit","Delete"],onActionChange:s,onClickAction:d,rowsPerPage:c=10}=e;const[g,C]=(0,n.useState)(1),E=Math.ceil(t.length/c),A=t.slice((g-1)*c,g*c);return(0,Z.jsxs)(_.Z,{children:[(0,Z.jsx)(m.Z,{children:(0,Z.jsxs)(p.Z,{children:[(0,Z.jsx)(u.Z,{children:(0,Z.jsxs)(h.Z,{children:[l&&(0,Z.jsx)(y.Z,{sx:{color:"primary.main"},children:"SLNO"}),a.map(((e,t)=>(0,Z.jsx)(y.Z,{sx:{color:"primary.main"},children:e},t))),o&&(0,Z.jsx)(y.Z,{sx:{color:"primary.main"},children:"Action"})]})}),(0,Z.jsx)(x.Z,{children:A.map(((e,t)=>(0,Z.jsxs)(h.Z,{onClick:()=>(e=>{d&&d(e)})(e._id),children:[l&&(0,Z.jsx)(y.Z,{children:(g-1)*c+t+1}),a.map(((t,a)=>{const n=t.replace(/\s+/g,"_"),r=e[t];if("IMAGE"===t.toUpperCase())return(0,Z.jsx)(y.Z,{children:(0,Z.jsx)("img",{style:{height:"100px"},src:r,alt:"img"})},a);if("isHighRangeArea"!==e.status&&"ISHIGHRANGEAREA"===t.toUpperCase())return(0,Z.jsx)(y.Z,{children:r?"Yes":"No"},a);if("PREMIUM_ENABLED"===t.toUpperCase().replace(/\s+/g,"_")){const n="Yes"==e[`${t}`];return(0,Z.jsx)(y.Z,{children:(0,Z.jsx)(v.Z,{label:n?"Yes":"No",size:"small",variant:"filled",sx:{color:"#fff",backgroundColor:n?"success.main":"#424242"}})},a)}if("PREMIUM_ENABLED"===n){const e="Yes"===r||1===r||!0===r;return(0,Z.jsx)(y.Z,{children:(0,Z.jsx)(v.Z,{label:e?"Yes":"No",size:"small",variant:"filled",sx:{color:"#fff",backgroundColor:e?"success.main":"#424242"}})},a)}return"STATUS"===t.toUpperCase()?(0,Z.jsx)(y.Z,{children:r?"Active":"Inactive"},a):(0,Z.jsx)(y.Z,{children:r},a)})),o&&(0,Z.jsx)(y.Z,{children:(0,Z.jsx)(f.Z,{data:e,onActionChange:e=>s(e),actions:i})})]},t)))})]})}),E>1&&(0,Z.jsx)(r.Z,{direction:"row",justifyContent:"flex-end",sx:{p:2},children:(0,Z.jsx)(j.Z,{count:E,page:g,onChange:(e,t)=>{C(t)},color:"primary",shape:"rounded"})})]})}var C=a(5266),E=a(9019),A=a(4631),b=a(1387),S=a(7825),w=a(4353),k=a(3929),N=a(24),P=a(1095),D=(a(6031),a(5627)),I=a(2186),T=a(1322);function U(e){let{selectedCompany:t,getData:a,addData:l,open:o,onClose:i,isEdit:s=!1,data:d={},type:c}=e;const[m,p]=(0,n.useState)(1===(null===d||void 0===d?void 0:d.active)),[u,h]=(0,n.useState)(1===(null===d||void 0===d?void 0:d.premium_enabled)),[y,x]=(0,n.useState)([]),[v,j]=(0,n.useState)(null),{control:_,setValue:f,handleSubmit:g,formState:{errors:C}}=(0,D.cI)({defaultValues:{employee_code:(null===d||void 0===d?void 0:d.employee_code)||"",employee_name:(null===d||void 0===d?void 0:d.employee_name)||"",department_id:(null===d||void 0===d?void 0:d.department_id)||"",premium_enabled:(null===d||void 0===d?void 0:d.premium_enabled)||0,active:(null===d||void 0===d?void 0:d.Active)||(null===d||void 0===d?void 0:d.active)||1}});(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,T.iI)();if(x(e),s&&null!==d&&void 0!==d&&d.department_id){const t=e.find((e=>e.department_id===d.department_id));t&&(j(t),f("department_id",t.department_id))}}catch(e){console.error("Error fetching departments:",e),b.Am.error("Error loading departments")}})()}),[s]);return(0,Z.jsx)(I.Z,{open:o,fullWidth:!0,onClose:i,title:`${s?"Edit":"Add"} ${c||"Employee"}`,children:(0,Z.jsx)("form",{onSubmit:g((e=>{if(""===t||void 0===t)return void b.Am.error("Please select a company first");if(""===c||void 0===c)return void b.Am.error("Please select a employee type first");const n={employee_code:e.employee_code,employee_name:e.employee_name,employee_type:c,company_id:t,department_id:e.department_id,premium_enabled:u?1:0,active:m?1:0};s&&(n.employee_id=d.employee_id),l(n).then((e=>{console.log(e),b.Am.success(s?"Employee Updated Successfully":"Employee Added Successfully"),a(),i()})).catch((e=>{var t,a;console.error(e),b.Am.error((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Error saving employee")}))})),children:(0,Z.jsx)(S.Z,{children:(0,Z.jsxs)(r.Z,{direction:"column",sx:{p:2},spacing:2,children:[(0,Z.jsx)(D.Qr,{name:"employee_code",control:_,rules:{required:"Employee Code is required"},render:e=>{var t;let{field:a}=e;return(0,Z.jsx)(A.Z,{...a,label:"Employee Code",error:Boolean(C.employee_code),helperText:null===(t=C.employee_code)||void 0===t?void 0:t.message,fullWidth:!0})}}),(0,Z.jsx)(D.Qr,{name:"employee_name",control:_,rules:{required:"Employee Name is required"},render:e=>{var t;let{field:a}=e;return(0,Z.jsx)(A.Z,{...a,label:"Employee Name",error:Boolean(C.employee_name),helperText:null===(t=C.employee_name)||void 0===t?void 0:t.message,fullWidth:!0})}}),(0,Z.jsx)(D.Qr,{name:"department_id",control:_,rules:{required:"Department is required"},render:e=>{let{field:t}=e;return(0,Z.jsx)(w.Z,{options:y,getOptionLabel:e=>e.department_name||"",value:y.find((e=>e.department_id===t.value))||null,onChange:(e,a)=>{t.onChange(null===a||void 0===a?void 0:a.department_id),j(a)},isOptionEqualToValue:(e,t)=>e.department_id===t.department_id,renderInput:e=>{var t;return(0,Z.jsx)(A.Z,{...e,label:"Department",error:Boolean(C.department_id),helperText:null===(t=C.department_id)||void 0===t?void 0:t.message})}})}}),(0,Z.jsx)(k.Z,{control:(0,Z.jsx)(N.Z,{checked:u,onChange:e=>h(e.target.checked)}),label:"Premium Enabled"}),(0,Z.jsx)(k.Z,{control:(0,Z.jsx)(N.Z,{checked:m,onChange:e=>p(e.target.checked)}),label:"Active"}),(0,Z.jsx)(P.Z,{variant:"contained",type:"submit",sx:{width:"150px"},children:s?"Update":"Add"})]})})})})}const Y=["Employee Code","Employee Name","Employee Type","Company","Department","Premium Enabled","Active"];function L(e){let{data:t,deleteAd:a,updateData:r,selectedCompany:l,type:m}=e;const[p,u]=(0,n.useState)(!1),[h,y]=(0,n.useState)(),[x,v]=(0,n.useState)(""),[j,_]=(0,n.useState)(""),f=t.filter((e=>{const t=""===x.trim()||e.employee_name.toLowerCase().includes(x.toLowerCase())||e.employee_code.toLowerCase().includes(x.toLowerCase()),a=""===j||e.Active.toString()===j;return t&&a})),b=(0,C.h)(f,["employee_code","employee_name","employee_type","company_id","department_name","premium_enabled","Active"],Y).map((e=>({...e,"Premium Enabled":1===e["Premium Enabled"]?"Yes":"No","Employee Type":m,Active:1===e.Active?"Yes":"No"})));return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(o.Z,{sx:{mb:2},children:(0,Z.jsxs)(E.ZP,{container:!0,spacing:2,children:[(0,Z.jsx)(E.ZP,{item:!0,xs:12,md:6,children:(0,Z.jsx)(A.Z,{label:"Search by Employee Name/Code",variant:"outlined",size:"small",fullWidth:!0,value:x,onChange:e=>v(e.target.value)})}),(0,Z.jsx)(E.ZP,{item:!0,xs:12,md:6,children:(0,Z.jsxs)(i.Z,{fullWidth:!0,size:"small",children:[(0,Z.jsx)(s.Z,{children:"Active"}),(0,Z.jsxs)(d.Z,{value:j,label:"Active",onChange:e=>_(e.target.value),children:[(0,Z.jsx)(c.Z,{value:"",children:"All"}),["1","0"].map((e=>(0,Z.jsx)(c.Z,{value:e,children:"1"===e?"Active":"Inactive"},e)))]})]})})]})}),p&&(0,Z.jsx)(U,{open:p,onClose:()=>{u(!1),y(null),r()},addData:T.to,getData:r,data:h,selectedCompany:l,isEdit:Boolean(h),type:m}),(0,Z.jsx)(g,{data:b,header:Y,isShowSerialNo:!0,isShowAction:!0,actions:["edit"],onActionChange:e=>{if(console.log(e),"delete"===e.action)y(e.data);else if("edit"===e.action){const t={employee_id:e.data.employee_id,employee_code:e.data["Employee Code"],employee_name:e.data["Employee Name"],company_id:e.data.company_id,department_id:e.data.department_id,premium_enabled:"Yes"===e.data["Premium Enabled"]?1:0,active:"Yes"===e.data.Active?1:0};y(t),u(!0)}},rowsPerPage:20})]})}var q=a(2040);function M(e){let{buttonClick:t,type:a,selectedCompany:n}=e;return(0,Z.jsx)(_.Z,{children:(0,Z.jsxs)(r.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,Z.jsxs)(l.Z,{variant:"h3",color:"secondary.main",children:["Manage ",a||"Employees / Contractor / Guest"]}),(0,Z.jsxs)(P.Z,{disabled:(console.log("heey"),""==n||void 0==n||null==n),variant:"contained",startIcon:(0,Z.jsx)(q.Z,{}),sx:{backgroundColor:"secondary.main"},onClick:t,children:["Add ",a||"Employees"]})]})})}function W(){const[e,t]=(0,n.useState)(!1),[a,m]=(0,n.useState)([]),[p,u]=(0,n.useState)([]),[h,y]=(0,n.useState)(""),[x,v]=(0,n.useState)("employee"),j=async()=>{try{if(!h)return void m([]);const e=await(0,T.Jf)(h,x);m(e)}catch(e){console.error(e),b.Am.error("Error fetching employees")}};return(0,n.useEffect)((()=>{(async()=>{try{let e=localStorage.getItem("companies");e&&u(JSON.parse(e))}catch(e){console.error(e),b.Am.error("Error fetching companies")}})()}),[]),(0,n.useEffect)((()=>{j()}),[h,x]),(0,Z.jsxs)(r.Z,{direction:"column",gap:2,children:[(0,Z.jsx)(l.Z,{variant:"h3",color:"secondary.main",children:"Select Company"}),(0,Z.jsx)(o.Z,{sx:{mb:1},children:(0,Z.jsxs)(r.Z,{direction:{xs:"column",md:"row"},spacing:2,children:[(0,Z.jsxs)(i.Z,{fullWidth:!0,children:[(0,Z.jsx)(s.Z,{children:"Select Company"}),(0,Z.jsxs)(d.Z,{value:h,label:"Select Company",onChange:e=>y(e.target.value),children:[(0,Z.jsx)(c.Z,{value:"",children:(0,Z.jsx)("em",{children:"Select a company"})}),p.map((e=>(0,Z.jsx)(c.Z,{value:e.company_id,children:e.company_name},e.company_id)))]})]}),(0,Z.jsxs)(i.Z,{fullWidth:!0,children:[(0,Z.jsx)(s.Z,{children:"Employee Type"}),(0,Z.jsx)(d.Z,{value:x,label:"Employee Type",onChange:e=>v(e.target.value),children:["employee","contractor","guest"].map((e=>(0,Z.jsx)(c.Z,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]})]})}),(0,Z.jsx)(U,{open:e,onClose:()=>t(!1),getData:j,addData:T.xk,selectedCompany:h,type:x}),(0,Z.jsx)(M,{selectedCompany:h,buttonClick:()=>{h?t(!0):b.Am.error("Please select a company first")},type:x}),(0,Z.jsx)(L,{selectedCompany:h,data:a,updateData:j,type:x})]})}}}]);