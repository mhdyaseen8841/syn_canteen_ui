"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[306],{1322:function(e,n,t){t.d(n,{BO:function(){return j},BZ:function(){return u},EP:function(){return d},Jf:function(){return m},T:function(){return f},TC:function(){return w},U1:function(){return C},Ug:function(){return Z},YD:function(){return S},Ym:function(){return x},_2:function(){return i},ai:function(){return I},iI:function(){return c},k:function(){return v},lQ:function(){return l},ly:function(){return b},nX:function(){return g},qL:function(){return _},r7:function(){return r},tI:function(){return s},to:function(){return h},uI:function(){return y},x4:function(){return a},xk:function(){return p}});const o=t(5662).Z.create({baseURL:"http://192.168.1.8:4001/api/",headers:{"Content-Type":"application/json"}});async function a(e){const n=await o.post("users/login",e);return n.data.access_token&&localStorage.setItem("token",n.data.access_token),n.data}async function r(){return(await o.get("menu")).data}async function i(e){return(await o.put("menu",e)).data}async function s(){return(await o.get("company")).data}async function l(e){return(await o.post("company",e)).data}async function c(){return(await o.get("department")).data}async function u(e){return(await o.post("department",e)).data}async function d(e){return(await o.put("department",e)).data}async function m(e,n){return(await o.get(`employee?company_id=${e}&employee_type=${n}`)).data}async function p(e){return(await o.post("employee",e)).data}async function h(e){return(await o.put("employee",e)).data}async function x(e){return(await o.post("/employee/search",e)).data}async function f(e){return(await o.post("/get-current-transaction",e)).data}async function g(e){return(await o.post("employee-transaction",e)).data}async function y(e){return(await o.post("delete-employee-transaction",e)).data}async function b(e){return(await o.post("fixed-transaction",e)).data}async function j(e){return(await o.post("contractor-transaction",e)).data}async function Z(e){return(await o.post("guest-transaction",e)).data}async function I(e){return(await o.post("expense",e)).data}async function _(e){return(await o.put("expense",e)).data}async function S(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const t=await o.get("expense?canteen_calendar_id="+e+"&menu_id="+n);return t.data}async function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const n=await o.get(`canteen-calender?is_settled=${e}`);return n.data}async function w(e){return(await o.post("do-settlement",e)).data}async function v(e){return(await o.get(`settlement-rates?canteenCalenderId=${e}`)).data}o.interceptors.request.use((async e=>{const n=localStorage.getItem("accessToken");return n?e.headers.Authorization="Bearer "+n:console.warn("Token not found in localStorage"),e}),(e=>Promise.reject(e))),o.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(console.log("Unauthorized, logging out..."),localStorage.clear(),Navigate("/login"),window.location.href="/login"),Promise.reject(e))))},2152:function(e,n,t){t.r(n),t.d(n,{default:function(){return v}});var o=t(7313),a=t(6149),r=t(3604),i=t(1113),s=t(6467),l=t(1806),c=t(4631),u=t(5281),d=t(4117),m=t(1095),p=t(2832),h=t(9019),x=t(3428),f=t(3405),g=t(1387),y=t(4353),b=t(1360),j=t(9642),Z=t(8738),I=t(1322),_=(t(5063),t(6417));const S=[{id:1,label:"Tech Solutions Inc."},{id:2,label:"Global Finance Ltd."},{id:3,label:"Creative Designs Co."},{id:4,label:"Manufacturing Experts"}],C={1:[{id:1,label:"John Smith"},{id:2,label:"Sarah Johnson"}],2:[{id:3,label:"Michael Chen"},{id:4,label:"Lisa Wong"}],3:[{id:5,label:"David Miller"},{id:6,label:"Emma Davis"}],4:[{id:7,label:"Robert Taylor"},{id:8,label:"Patricia Brown"}]},w={1:[{id:1,label:"Alex Turner"},{id:2,label:"Sophie Wilson"}],2:[{id:3,label:"James Harris"},{id:4,label:"Olivia Clark"}],3:[{id:5,label:"William Lee"},{id:6,label:"Grace Lopez"}],4:[{id:7,label:"Daniel Martinez"},{id:8,label:"Natalie Adams"}]};function v(){const[e,n]=(0,o.useState)(null),[t,v]=(0,o.useState)({menuItem:null,coupons:1}),[P,T]=(0,o.useState)(!1),[W,O]=(0,o.useState)({company:null,contractor:null,date:(new Date).toISOString().split("T")[0],menuItem:null,coupons:1}),[k,L]=(0,o.useState)({company:null,guest:null,menuItem:null,coupons:1,date:(new Date).toISOString().split("T")[0]}),[z,D]=(0,o.useState)([]),[A,E]=(0,o.useState)([]),[B,G]=(0,o.useState)([]),[M,q]=(0,o.useState)([]),[F,N]=(0,o.useState)(""),[$,J]=(0,o.useState)(""),[R,U]=(0,o.useState)(""),[V,Y]=(0,o.useState)(""),[H,Q]=(0,o.useState)(null),[X,K]=(0,o.useState)(!1),ee=(S.filter((e=>e.label.toLowerCase().includes($.toLowerCase()))),(W.company&&C[W.company.id]||[]).filter((e=>e.label.toLowerCase().includes(R.toLowerCase()))),(k.company&&w[k.company.id]||[]).filter((e=>e.label.toLowerCase().includes(V.toLowerCase()))),e=>{n(e),N(""),J(""),U(""),Y(""),"contractor"!==e&&"guest"!==e||(0,I.tI)().then((e=>{E(e)})).catch((e=>{console.error(e),g.Am.error("Error fetching menu items")}))}),ne=()=>{n(null)},te=(e,n)=>{"contractor"===e?(O({...W,company:n,contractor:null}),(0,I.Jf)(n.company_id,"contractor").then((e=>{G(e)})).catch((e=>{console.error(e),g.Am.error("Error fetching contractors")}))):"guest"===e&&(L({...k,company:n,guest:null}),(0,I.Jf)(n.company_id,"guest").then((e=>{q(e)})).catch((e=>{console.error(e),g.Am.error("Error fetching Guests")})))};(0,o.useEffect)((()=>{(0,I.r7)().then((e=>{D(e)})).catch((e=>{console.error(e),g.Am.error("Error fetching menu items")}))}),[]);const oe=()=>{const{menuItem:e,coupons:n}=t;(0,I.ly)({menu_id:e.menu_id,no_of_entries:n}).then((t=>{console.log(t),Q({type:"Fixed",menu_name:e.menu_name,no_of_entries:n,transaction_id:t.transaction_id,date:(new Date).toLocaleDateString()}),K(!0)})).catch((e=>{console.error(e),g.Am.error("Error submitting fixed transaction")}));for(let t=0;t<n;t++)console.log(`Submitting Fixed Transaction ${t+1}:`,e.menu_id);ne(),v({menuItem:null,coupons:1})},ae=()=>{const{company:e,contractor:n,menuItem:t,coupons:o,date:a}=W;let r={company_id:e.company_id,employee_id:n.employee_id,menu_id:t.menu_id,no_of_entries:o,trasaction_time:a};(0,I.BO)(r).then((e=>{console.log(e)})).catch((e=>{console.error(e),g.Am.error("Error submitting contractor transaction")}));for(let i=0;i<o;i++)console.log(`Submitting Contractor Transaction ${i+1}:`,{company:e,contractor:n,menuItem:t,date:a});ne(),O({company:null,contractor:null,date:(new Date).toISOString().split("T")[0],menuItem:null,coupons:1})},re=()=>{const{company:e,guest:n,menuItem:t,coupons:o,date:a}=k;let r={company_id:e.company_id,employee_id:n.employee_id,menu_id:t.menu_id,no_of_entries:o,trasaction_time:a};for(let i=0;i<o;i++)console.log(`Submitting Guest Transaction ${i+1}:`,{company:e,guest:n,menuItem:t,date:a});(0,I.Ug)(r).then((e=>{console.log(e)})).catch((e=>{console.error(e),g.Am.error("Error submitting contractor transaction")})),ne(),L({company:null,guest:null,menuItem:null,coupons:1,date:(new Date).toISOString().split("T")[0]})};return(0,_.jsxs)(l.Z,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[(0,_.jsxs)(h.ZP,{container:!0,spacing:3,children:[(0,_.jsx)(h.ZP,{item:!0,xs:12,sm:4,children:(0,_.jsx)(x.Z,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:(0,_.jsxs)(f.Z,{onClick:()=>ee("fixed"),sx:{cursor:"pointer",flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[(0,_.jsx)(l.Z,{sx:{p:2,bgcolor:"#4682B4",borderRadius:"50%",mb:2},children:(0,_.jsx)(b.Z,{size:40,color:"#ffff"})}),(0,_.jsx)(i.Z,{variant:"h5",component:"h2",gutterBottom:!0,children:"Fixed"}),(0,_.jsx)(i.Z,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Process fixed menu transactions with specified number of coupons"}),(0,_.jsx)(m.Z,{variant:"contained",color:"primary",sx:{mt:"auto"},fullWidth:!0,children:"Select"})]})})}),(0,_.jsx)(h.ZP,{item:!0,xs:12,sm:4,children:(0,_.jsx)(x.Z,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:(0,_.jsxs)(f.Z,{onClick:()=>ee("contractor"),sx:{cursor:"pointer",flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[(0,_.jsx)(l.Z,{sx:{p:2,backgroundColor:"#6a3d8c",borderRadius:"50%",mb:2},children:(0,_.jsx)(j.Z,{size:40,color:"#fff"})}),(0,_.jsx)(i.Z,{variant:"h5",component:"h2",gutterBottom:!0,children:"Contractor"}),(0,_.jsx)(i.Z,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Process transactions for contractors from registered companies"}),(0,_.jsx)(m.Z,{variant:"contained",color:"secondary",sx:{mt:"auto"},fullWidth:!0,children:"Select"})]})})}),(0,_.jsx)(h.ZP,{item:!0,xs:12,sm:4,children:(0,_.jsx)(x.Z,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:(0,_.jsxs)(f.Z,{onClick:()=>ee("guest"),sx:{cursor:"pointer",flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[(0,_.jsx)(l.Z,{sx:{p:2,bgcolor:"#388e3c",borderRadius:"50%",mb:2},children:(0,_.jsx)(Z.Z,{size:40,color:"#fff"})}),(0,_.jsx)(i.Z,{variant:"h5",component:"h2",gutterBottom:!0,children:"Guest"}),(0,_.jsx)(i.Z,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Process transactions for guests visiting from registered companies"}),(0,_.jsx)(m.Z,{variant:"contained",color:"success",sx:{mt:"auto",color:"white"},fullWidth:!0,children:"Select"})]})})})]}),(0,_.jsxs)(a.Z,{open:"fixed"===e,onClose:ne,maxWidth:"sm",fullWidth:!0,children:[(0,_.jsx)(r.Z,{children:(0,_.jsx)(i.Z,{variant:"h4",children:"Fixed Transaction"})}),(0,_.jsx)(s.Z,{children:(0,_.jsxs)(l.Z,{sx:{mt:2},children:[(0,_.jsxs)(l.Z,{sx:{mb:3},children:[(0,_.jsx)(i.Z,{variant:"subtitle1",gutterBottom:!0,children:"Menu Item"}),(0,_.jsx)(y.Z,{options:z,getOptionLabel:e=>e.menu_name,loading:P,value:t.menuItem||null,onChange:(e,n)=>v({...t,menuItem:n}),renderInput:e=>(0,_.jsx)(c.Z,{...e,placeholder:"Search menu items...",fullWidth:!0,InputProps:{...e.InputProps,endAdornment:(0,_.jsxs)(_.Fragment,{children:[P?(0,_.jsx)(u.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}}),noOptionsText:P?"Loading...":"No items found"})]}),(0,_.jsx)(c.Z,{label:"Number of Coupons",type:"number",fullWidth:!0,value:t.coupons,onChange:e=>v({...t,coupons:Math.max(1,parseInt(e.target.value)||1)}),InputProps:{inputProps:{min:1}}})]})}),(0,_.jsxs)(d.Z,{children:[(0,_.jsx)(m.Z,{onClick:ne,children:"Cancel"}),(0,_.jsx)(m.Z,{onClick:oe,variant:"contained",color:"primary",disabled:!t.menuItem,children:"Submit"})]})]}),(0,_.jsxs)(a.Z,{open:"contractor"===e,onClose:ne,maxWidth:"sm",fullWidth:!0,children:[(0,_.jsx)(r.Z,{sx:{fontSize:"1.5rem",fontWeight:600},children:"Contractor Transaction"}),(0,_.jsx)(s.Z,{sx:{px:3,py:2},children:(0,_.jsxs)(p.Z,{spacing:3,children:[(0,_.jsx)(y.Z,{options:A,getOptionLabel:e=>e.company_name,value:W.company||null,onChange:(e,n)=>te("contractor",n),renderInput:e=>(0,_.jsx)(c.Z,{...e,label:"Company",placeholder:"Search companies...",fullWidth:!0,size:"medium"}),isOptionEqualToValue:(e,n)=>e.id===n.id}),(0,_.jsx)(y.Z,{options:B,getOptionLabel:e=>e.employee_name,value:W.contractor||null,onChange:(e,n)=>O({...W,contractor:n}),renderInput:e=>(0,_.jsx)(c.Z,{...e,label:"Contractor",placeholder:"Search contractors...",fullWidth:!0,size:"medium"}),isOptionEqualToValue:(e,n)=>e.id===n.id,disabled:!W.company}),(0,_.jsx)(c.Z,{type:"date",label:"Date",fullWidth:!0,value:W.date,onChange:e=>O({...W,date:e.target.value}),InputProps:{inputProps:{min:(new Date).toISOString().split("T")[0]}},size:"medium"}),(0,_.jsx)(y.Z,{options:z,getOptionLabel:e=>e.menu_name,loading:P,value:W.menuItem||null,onChange:(e,n)=>O({...W,menuItem:n}),renderInput:e=>(0,_.jsx)(c.Z,{...e,label:"Menu Item",placeholder:"Search menu items...",fullWidth:!0,size:"medium",InputProps:{...e.InputProps,endAdornment:(0,_.jsxs)(_.Fragment,{children:[P?(0,_.jsx)(u.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}}),noOptionsText:P?"Loading...":"No items found"}),(0,_.jsx)(c.Z,{label:"Number of Coupons",type:"number",fullWidth:!0,value:W.coupons,onChange:e=>O({...W,coupons:Math.max(1,parseInt(e.target.value)||1)}),InputProps:{inputProps:{min:1}},size:"medium"})]})}),(0,_.jsxs)(d.Z,{sx:{px:3,pb:2},children:[(0,_.jsx)(m.Z,{onClick:ne,children:"Cancel"}),(0,_.jsx)(m.Z,{onClick:ae,variant:"contained",color:"primary",disabled:!W.company||!W.contractor||!W.menuItem||!W.date,children:"Submit"})]})]}),(0,_.jsxs)(a.Z,{open:"guest"===e,onClose:ne,maxWidth:"sm",fullWidth:!0,children:[(0,_.jsx)(r.Z,{sx:{fontSize:"1.5rem",fontWeight:600},children:"Guest Transaction"}),(0,_.jsx)(s.Z,{sx:{px:3,py:2},children:(0,_.jsxs)(p.Z,{spacing:3,children:[(0,_.jsx)(y.Z,{options:A,getOptionLabel:e=>e.company_name,value:k.company||null,onChange:(e,n)=>te("guest",n),renderInput:e=>(0,_.jsx)(c.Z,{...e,label:"Company",placeholder:"Search companies...",fullWidth:!0,size:"medium"}),isOptionEqualToValue:(e,n)=>e.id===n.id}),(0,_.jsx)(y.Z,{options:M,getOptionLabel:e=>e.employee_name,value:k.guest||null,onChange:(e,n)=>L({...k,guest:n}),renderInput:e=>(0,_.jsx)(c.Z,{...e,label:"Guest",placeholder:"Search guests...",fullWidth:!0,size:"medium"}),isOptionEqualToValue:(e,n)=>e.id===n.id,disabled:!k.company}),(0,_.jsx)(y.Z,{options:z,getOptionLabel:e=>e.menu_name,value:k.menuItem||null,onChange:(e,n)=>L({...k,menuItem:n}),renderInput:e=>(0,_.jsx)(c.Z,{...e,label:"Menu Item",placeholder:"Search menu items...",fullWidth:!0,size:"medium"}),isOptionEqualToValue:(e,n)=>e.id===n.id}),(0,_.jsx)(c.Z,{type:"date",label:"Date",fullWidth:!0,value:k.date,onChange:e=>L({...k,date:e.target.value}),InputProps:{inputProps:{min:(new Date).toISOString().split("T")[0]}},size:"medium"}),(0,_.jsx)(c.Z,{label:"Number of Coupons",type:"number",fullWidth:!0,value:k.coupons,onChange:e=>L({...k,coupons:Math.max(1,parseInt(e.target.value)||1)}),InputProps:{inputProps:{min:1}},size:"medium"})]})}),(0,_.jsxs)(d.Z,{sx:{px:3,pb:2},children:[(0,_.jsx)(m.Z,{onClick:ne,children:"Cancel"}),(0,_.jsx)(m.Z,{onClick:re,variant:"contained",color:"primary",disabled:!k.company||!k.guest||!k.menuItem,children:"Submit"})]})]})]})}}}]);